<div class="leaderboard-container">
  <div class="leaderboard-header">
    <h1 class="page-title">Leaderboard</h1>
    <p class="page-subtitle">See how you stack up against other learners</p>

    <div class="timeframe-selector">
      <button
        class="timeframe-btn"
        [class.active]="timeFrame === TimeFrame.Weekly"
        (click)="setTimeFrame(TimeFrame.Weekly)">
        Weekly
      </button>
      <button
        class="timeframe-btn"
        [class.active]="timeFrame === TimeFrame.Monthly"
        (click)="setTimeFrame(TimeFrame.Monthly)">
        Monthly
      </button>
      <button
        class="timeframe-btn"
        [class.active]="timeFrame === TimeFrame.AllTime"
        (click)="setTimeFrame(TimeFrame.AllTime)">
        All Time
      </button>
    </div>
  </div>

  @if (isLoading) {
  <div class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading rankings...</p>
  </div>
  } @else if (leaderboardEntries.length === 0) {
  <div class="empty-state">
    <p>No activity yet for this time period. Start learning to climb the ranks!</p>
  </div>
  } @else {
  <div class="leaderboard-list">
    @for (entry of leaderboardEntries; track entry.userId) {
    <div
      class="leaderboard-card"
      [class.current-user]="entry.isCurrentUser"
      [class.top-three]="entry.rank <= 3">

      <div class="rank-section">
        <div class="rank-badge" [class]="getRankBadgeClass(entry.rank)">
          @if (entry.rank <= 3) {
          <span class="rank-icon">{{ getRankIcon(entry.rank) }}</span>
          } @else {
          <span class="rank-number">#{{ entry.rank }}</span>
          }
        </div>
        <div class="rank-change" [class]="getChangeClass(entry.change)">
          <span class="change-icon">{{ getChangeIcon(entry.change) }}</span>
          @if (entry.change !== 0) {
          <span class="change-value">{{ entry.change < 0 ? -entry.change : entry.change }}</span>
          }
        </div>
      </div>

      <div class="user-section">
        <img [src]="getAvatarUrl(entry)" [alt]="entry.userName" class="user-avatar">
        <div class="user-info">
          <h3 class="user-name">{{ entry.userName }}</h3>
          <div class="user-level">Level {{ entry.level }}</div>
        </div>
      </div>

      <div class="stats-section">
        <div class="stat-item">
          <div class="stat-icon">âš¡</div>
          <div class="stat-details">
            <div class="stat-value">{{ entry.totalXp.toLocaleString() }}</div>
            <div class="stat-label">Total XP</div>
          </div>
        </div>

        <div class="stat-item">
          <div class="stat-icon">ğŸ”¥</div>
          <div class="stat-details">
            <div class="stat-value">{{ entry.currentStreak }}</div>
            <div class="stat-label">Streak</div>
          </div>
        </div>

        <div class="stat-item">
          <div class="stat-icon">ğŸ†</div>
          <div class="stat-details">
            <div class="stat-value">{{ entry.longestStreak }}</div>
            <div class="stat-label">Best</div>
          </div>
        </div>
      </div>
    </div>
    }
  </div>
  }
</div>
